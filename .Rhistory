for (h in 1:horizons) {
df <- rbind(df, data.frame(
variable = var_names[v],
horizon = h - 1,
median = proj_irfs["50%", v, h],
lower = proj_irfs["16%", v, h],
upper = proj_irfs["84%", v, h]
))
}
}
library(ggplot2)
ggplot(df, aes(x = horizon, y = median)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = "IRFs to Dominant CA Shock with Confidence Bands", y = "Response", x = "Horizon") +
theme_minimal()
}
approx_boer_bands <- function(proj_irfs) {
proj_irfs["5%", , ] <- proj_irfs["16%", , ] - (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * 1.5
proj_irfs["95%", , ] <- proj_irfs["84%", , ] + (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * 1.5
return(proj_irfs)
}
proj_irfs_list <- map2(irf_list, q_vectors, compute_dominant_irfs_quants) %>%
map(approx_boer_bands)
approx_boer_bands <- function(proj_irfs) {
if (is.null(proj_irfs)) return(NULL)
# Get current quantile names
q_names <- dimnames(proj_irfs)[[1]]
if (!all(c("5%", "95%") %in% q_names)) {
# Create new array with 5 quantiles
new_q_names <- c("5%", q_names, "95%")
new_proj_irfs <- array(NA, dim = c(5, dim(proj_irfs)[2], dim(proj_irfs)[3]))
dimnames(new_proj_irfs) <- list(new_q_names, NULL, NULL)
# Copy existing quantiles
new_proj_irfs["16%", , ] <- proj_irfs["16%", , ]
new_proj_irfs["50%", , ] <- proj_irfs["50%", , ]
new_proj_irfs["84%", , ] <- proj_irfs["84%", , ]
# Compute approximated 5% and 95% bands
new_proj_irfs["5%", , ] <- proj_irfs["16%", , ] - (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * 1.5
new_proj_irfs["95%", , ] <- proj_irfs["84%", , ] + (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * 1.5
return(new_proj_irfs)
} else {
return(proj_irfs)
}
}
proj_irfs_list <- map2(irf_list, q_vectors, compute_dominant_irfs_quants) %>%
map(approx_boer_bands)
var_names <- c("CAoverGDP", "NEER", "log_cons", "log_inv", "log_tfp", "logforcons", "logforinv", "cpidiff", "irdiff")
plot_irf_with_bands(proj_irfs_list[["USA"]], var_names)
var_names <- c("CAoverGDP", "NEER", "log_cons", "log_inv", "log_tfp", "logforcons", "logforinv", "cpidiff", "irdiff")
plot_irf_with_bands(proj_irfs_list[["USA"]], var_names)
approx_boer_bands <- function(proj_irfs) {
if (is.null(proj_irfs)) return(NULL)
q_names <- dimnames(proj_irfs)[[1]]
if (!all(c("5%", "95%") %in% q_names)) {
new_q_names <- c("5%", q_names, "95%")
new_proj_irfs <- array(NA, dim = c(5, dim(proj_irfs)[2], dim(proj_irfs)[3]))
dimnames(new_proj_irfs) <- list(new_q_names, NULL, NULL)
new_proj_irfs["16%", , ] <- proj_irfs["16%", , ]
new_proj_irfs["50%", , ] <- proj_irfs["50%", , ]
new_proj_irfs["84%", , ] <- proj_irfs["84%", , ]
# Try a larger multiplier
factor <- 2  # instead of 1.5
new_proj_irfs["5%", , ] <- proj_irfs["16%", , ] - (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * factor
new_proj_irfs["95%", , ] <- proj_irfs["84%", , ] + (proj_irfs["84%", , ] - proj_irfs["16%", , ]) * factor
return(new_proj_irfs)
} else {
return(proj_irfs)
}
}
proj_irfs_list <- map2(irf_list, q_vectors, compute_dominant_irfs_quants) %>%
map(approx_boer_bands)
var_names <- c("CAoverGDP", "NEER", "log_cons", "log_inv", "log_tfp", "logforcons", "logforinv", "cpidiff", "irdiff")
plot_irf_with_bands(proj_irfs_list[["USA"]], var_names)
test_irf <- irf(country_models[["USA"]], h = 20)
summary(test_irf)$quants
var_names <- c("CAoverGDP", "NEER", "log_cons", "log_inv", "log_tfp", "logforcons", "logforinv", "cpidiff", "irdiff")
plot_irf_with_bands(proj_irfs_list[["USA"]], var_names)
quants_array
q_vectors
get_irfs <- function(bvar_model, H = 20, conf_bands = c(0.16, 0.84)) {
if (is.null(bvar_model)) return(NULL)
irf_obj <- irf(
bvar_model,
h = H,
identification = FALSE,
fevd = FALSE,
conf_bands = conf_bands
)
irf_summary <- summary(irf_obj)
quants_array <- irf_summary$quants
return(quants_array)
}
irf_68 <- get_irfs(bvar_model, conf_bands = c(0.16, 0.84))
irf_90 <- get_irfs(bvar_model, conf_bands = c(0.05, 0.95))
# 68% bands (default)
irf_list_68 <- map(country_models, ~get_irfs(.x, H = 20, conf_bands = c(0.16, 0.84)))
# 90% bands
irf_list_90 <- map(country_models, ~get_irfs(.x, H = 20, conf_bands = c(0.05, 0.95)))
# Check one country model
usa_model <- country_models[["USA"]]
# 68% bands
irf_68 <- get_irfs(usa_model, H = 20, conf_bands = c(0.16, 0.84))
dimnames(irf_68)[[1]]  # Should show "16%", "50%", "84%"
# 90% bands
irf_90 <- get_irfs(usa_model, H = 20, conf_bands = c(0.05, 0.95))
dimnames(irf_90)[[1]]  # Should show "5%", "50%", "95%"
proj_irfs_list_68 <- map2(irf_list_68, q_vectors, compute_dominant_irfs_quants)
proj_irfs_list_90 <- map2(irf_list_90, q_vectors, compute_dominant_irfs_quants)
plot_irf_with_bands(proj_irfs_list_68[["USA"]], var_names)
plot_irf_with_bands(proj_irfs_list_90[["USA"]], var_names)
plot_irf_with_bands(proj_irfs_list_90[["USA"]], var_names)
plot_irf_with_bands <- function(proj_irfs, var_names) {
if (is.null(proj_irfs)) return(NULL)
horizons <- dim(proj_irfs)[3]
variables <- dim(proj_irfs)[2]
# Extract quantile names dynamically
quantile_names <- dimnames(proj_irfs)[[1]]
lower_name <- quantile_names[1]
median_name <- quantile_names[2]
upper_name <- quantile_names[3]
df <- data.frame()
for (v in 1:variables) {
for (h in 1:horizons) {
df <- rbind(df, data.frame(
variable = var_names[v],
horizon = h - 1,
median = proj_irfs[median_name, v, h],
lower = proj_irfs[lower_name, v, h],
upper = proj_irfs[upper_name, v, h]
))
}
}
library(ggplot2)
ggplot(df, aes(x = horizon, y = median)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = "IRFs to Dominant CA Shock with Confidence Bands", y = "Response", x = "Horizon") +
theme_minimal()
}
plot_irf_with_bands(proj_irfs_list_68[["USA"]], var_names)
plot_irf_with_bands(proj_irfs_list_90[["USA"]], var_names)
prepare_combined_irf_df <- function(proj_irfs_68, proj_irfs_90, var_names) {
if (is.null(proj_irfs_68) || is.null(proj_irfs_90)) return(NULL)
horizons <- dim(proj_irfs_68)[3]
variables <- dim(proj_irfs_68)[2]
# Get quantile names
q_68 <- dimnames(proj_irfs_68)[[1]]
q_90 <- dimnames(proj_irfs_90)[[1]]
df <- data.frame()
for (v in 1:variables) {
for (h in 1:horizons) {
df <- rbind(
df,
data.frame(
variable = var_names[v],
horizon = h - 1,
median = proj_irfs_68[q_68[2], v, h],
lower = proj_irfs_90[q_90[1], v, h],
upper = proj_irfs_90[q_90[3], v, h],
band = "90%"
),
data.frame(
variable = var_names[v],
horizon = h - 1,
median = proj_irfs_68[q_68[2], v, h],
lower = proj_irfs_68[q_68[1], v, h],
upper = proj_irfs_68[q_68[3], v, h],
band = "68%"
)
)
}
}
return(df)
}
plot_combined_irfs <- function(df) {
library(ggplot2)
ggplot(df, aes(x = horizon, y = median, group = band)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper, fill = band), alpha = 0.3) +
scale_fill_manual(values = c("68%" = "blue", "90%" = "lightblue")) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = "IRFs with 68% and 90% Bands", y = "Response", x = "Horizon") +
theme_minimal()
}
df_usa <- prepare_combined_irf_df(proj_irfs_list_68[["USA"]], proj_irfs_list_90[["USA"]], var_names)
plot_combined_irfs(df_usa)
knitr::opts_chunk$set(echo = TRUE)
#  Load Libraries
library(dplyr)
library(tidyr)
library(purrr)
library(readr)
library(BVAR)
library(ggplot2)
# Load Data
df <- read_csv("newvardata.csv")
country_list <- unique(df$code)
# ðŸ”¹ Estimate BVAR Models
estimate_country_var <- function(country_data) {
var_data <- country_data %>%
dplyr::select(CAoverGDP, log_neer, log_cons, log_inv,
logforcons, logforinv, cpidiff, irdiff) %>%
drop_na()
if (nrow(var_data) < 5) return(NULL)
col_vars <- apply(var_data, 2, var)
low_var_cols <- names(col_vars[col_vars < 1e-5])
if (length(low_var_cols) > 0) var_data <- var_data %>% select(-all_of(low_var_cols))
if (ncol(var_data) < 3) return(NULL)
psi_manual <- diag(0.1, ncol(var_data))
model <- tryCatch({
bvar(as.matrix(var_data), lags = 1, psi = psi_manual)
}, error = function(e) NULL)
return(model)
}
country_models <- df %>%
group_by(code) %>%
group_split() %>%
set_names(country_list) %>%
map(estimate_country_var)
# ðŸ”¹ Compute IRFs (68% and 90% Bands)
get_irfs <- function(bvar_model, H = 20, conf_bands = c(0.16, 0.84)) {
if (is.null(bvar_model)) return(NULL)
irf_summary <- summary(irf(bvar_model, h = H, conf_bands = conf_bands))
return(irf_summary$quants)
}
irf_list_68 <- map(country_models, ~get_irfs(.x, H = 20, conf_bands = c(0.16, 0.84)))
irf_list_90 <- map(country_models, ~get_irfs(.x, H = 20, conf_bands = c(0.05, 0.95)))
# ðŸ”¹ Compute Max-Share Vectors
compute_max_share <- function(irf_array, ca_index = 1) {
if (is.null(irf_array) || length(dim(irf_array)) != 4) return(NULL)
median_array <- irf_array["50%", , , ]
Theta <- Reduce(`+`, lapply(1:dim(median_array)[2], function(h) {
psi_h <- median_array[, h, ]
S <- matrix(0, nrow = nrow(psi_h), ncol = 1); S[ca_index, 1] <- 1
t(psi_h) %*% S %*% t(S) %*% psi_h
}))
eigen(Theta)$vectors[,1]
}
q_vectors <- map(irf_list_68, compute_max_share)
# ðŸ”¹ Compute Dominant IRFs
compute_dominant_irfs_quants <- function(irf_array, q_vector) {
if (is.null(irf_array) || length(dim(irf_array)) != 4) return(NULL)
quantile_names <- dimnames(irf_array)[[1]]
proj_irfs <- array(NA, dim = c(length(quantile_names), dim(irf_array)[2], dim(irf_array)[3]),
dimnames = list(quantile_names, NULL, NULL))
for (q in seq_along(quantile_names)) {
for (h in 1:dim(irf_array)[3]) {
psi_h <- irf_array[q, , h, ]
proj_irfs[q, , h] <- psi_h %*% q_vector
}
}
return(proj_irfs)
}
proj_irfs_list_68 <- map2(irf_list_68, q_vectors, compute_dominant_irfs_quants)
proj_irfs_list_90 <- map2(irf_list_90, q_vectors, compute_dominant_irfs_quants)
# ðŸ”¹ Combined Plotting
prepare_combined_irf_df <- function(proj_irfs_68, proj_irfs_90, var_names) {
if (is.null(proj_irfs_68) || is.null(proj_irfs_90)) return(NULL)
horizons <- dim(proj_irfs_68)[3]; variables <- dim(proj_irfs_68)[2]
q_68 <- dimnames(proj_irfs_68)[[1]]; q_90 <- dimnames(proj_irfs_90)[[1]]
df <- data.frame()
for (v in 1:variables) {
for (h in 1:horizons) {
df <- rbind(
df,
data.frame(variable = var_names[v], horizon = h - 1,
median = proj_irfs_68[q_68[2], v, h],
lower = proj_irfs_90[q_90[1], v, h],
upper = proj_irfs_90[q_90[3], v, h], band = "90%"),
data.frame(variable = var_names[v], horizon = h - 1,
median = proj_irfs_68[q_68[2], v, h],
lower = proj_irfs_68[q_68[1], v, h],
upper = proj_irfs_68[q_68[3], v, h], band = "68%")
)
}
}
return(df)
}
plot_combined_irfs <- function(df) {
ggplot(df, aes(x = horizon, y = median, group = band)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper, fill = band), alpha = 0.3) +
scale_fill_manual(values = c("68%" = "blue", "90%" = "lightblue")) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = "IRFs with 68% and 90% Bands", y = "Response", x = "Horizon") +
theme_minimal()
}
# ðŸ”¹ Example: USA
var_names <- c("CAoverGDP", "NEER", "log_cons", "log_inv", "log_tfp", "logforcons", "logforinv", "cpidiff", "irdiff")
df_usa <- prepare_combined_irf_df(proj_irfs_list_68[["USA"]], proj_irfs_list_90[["USA"]], var_names)
plot_combined_irfs(df_usa)
# Create output folder
output_dir <- "irf_plots"
if (!dir.exists(output_dir)) dir.create(output_dir)
save_country_irf_plot <- function(country_code, proj_irfs_list_68, proj_irfs_list_90, var_names, output_dir) {
# Get IRFs for the country
proj_68 <- proj_irfs_list_68[[country_code]]
proj_90 <- proj_irfs_list_90[[country_code]]
# Skip if missing
if (is.null(proj_68) || is.null(proj_90)) {
message("Skipping ", country_code, ": missing IRFs.")
return(NULL)
}
# Prepare the combined dataframe
df_plot <- prepare_combined_irf_df(proj_68, proj_90, var_names)
if (is.null(df_plot)) return(NULL)
# Generate plot
p <- plot_combined_irfs(df_plot) + ggtitle(paste("IRFs for", country_code))
# Save as PNG
file_path <- file.path(output_dir, paste0("IRF_", country_code, ".png"))
ggsave(filename = file_path, plot = p, width = 10, height = 6)
message("Saved IRF plot for ", country_code)
}
# Generate and save plots for all countries
walk(names(proj_irfs_list_68), ~save_country_irf_plot(.x, proj_irfs_list_68, proj_irfs_list_90, var_names, output_dir))
# Load PCA data
df_pcs <- read_csv("pcs.csv")
# Check structure
str(df_pcs)
# Preview rows
head(df_pcs)
# Unique codes
unique(df_var$code)
unique(df$code)
unique(df_pcs$Country.code)
View(df_pcs)
unique(df_pcs$Country.Code)
df_var_with_pcs <- df %>%
left_join(df_pcs, by = c("code" = "Country.Code"))
# Example: high/low BoP_PC1 groups
df_pcs <- df_pcs %>%
mutate(BoP_PC1_group = case_when(
BoP_PC1 >= quantile(BoP_PC1, 0.66, na.rm = TRUE) ~ "High",
BoP_PC1 <= quantile(BoP_PC1, 0.33, na.rm = TRUE) ~ "Low",
TRUE ~ "Mid"
))
# Extract country to group mapping
country_group_map <- df_pcs %>%
select(Country.Code, BoP_PC1_group) %>%
filter(Country.Code %in% names(proj_irfs_list_68))
# Extract country to group mapping
country_group_map <- df_pcs %>%
dplyr::select(Country.Code, BoP_PC1_group) %>%
filter(Country.Code %in% names(proj_irfs_list_68))
print(country_group_map)
# Function to compute group IRFs
compute_group_irfs <- function(proj_irfs_list, country_group_map) {
groups <- unique(country_group_map$BoP_PC1_group)
group_irfs <- list()
for (g in groups) {
group_countries <- country_group_map %>%
filter(BoP_PC1_group == g) %>%
pull(Country.Code)
# Collect IRFs for this group
group_irfs_array <- proj_irfs_list[group_countries] %>%
compact() %>%  # Remove NULLs
simplify2array()
if (length(dim(group_irfs_array)) == 4) {  # [quantiles x variables x horizons x countries]
# Compute median and quantiles across countries (4th dimension)
median_irf <- apply(group_irfs_array, c(1,2,3), median, na.rm = TRUE)
lower_irf  <- apply(group_irfs_array, c(1,2,3), function(x) quantile(x, 0.25, na.rm = TRUE))
upper_irf  <- apply(group_irfs_array, c(1,2,3), function(x) quantile(x, 0.75, na.rm = TRUE))
group_irfs[[g]] <- list(median = median_irf, lower = lower_irf, upper = upper_irf)
} else {
message("Group ", g, " has no valid IRFs.")
}
}
return(group_irfs)
}
# Run for 68% IRFs
group_irfs_68 <- compute_group_irfs(proj_irfs_list_68, country_group_map)
plot_group_irfs <- function(group_irfs, group_name, var_names) {
irfs <- group_irfs[[group_name]]
if (is.null(irfs)) {
message("No IRFs for group ", group_name)
return(NULL)
}
quantile_names <- dimnames(irfs$median)[[1]]
horizons <- dim(irfs$median)[3]
variables <- dim(irfs$median)[2]
df <- data.frame()
for (v in 1:variables) {
for (h in 1:horizons) {
df <- rbind(df, data.frame(
variable = var_names[v],
horizon = h - 1,
median = irfs$median[2, v, h],
lower = irfs$lower[v, h],
upper = irfs$upper[v, h]
))
}
}
ggplot(df, aes(x = horizon, y = median)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper), fill = "lightblue", alpha = 0.3) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = paste("Group IRFs for", group_name, "(68% Bands)"), y = "Response", x = "Horizon") +
theme_minimal()
}
plot_group_irfs(group_irfs_68, "High", var_names)
# Function to compute group IRFs
compute_group_irfs <- function(proj_irfs_list, country_group_map) {
groups <- unique(country_group_map$BoP_PC1_group)
group_irfs <- list()
for (g in groups) {
group_countries <- country_group_map %>%
filter(BoP_PC1_group == g) %>%
pull(Country.Code)
group_irfs_array <- proj_irfs_list[group_countries] %>%
compact() %>% simplify2array()
if (length(dim(group_irfs_array)) == 4) {  # [quantiles x variables x horizons x countries]
# Compute 50% (median), 25%, 75% quantiles across countries
median_irf <- apply(group_irfs_array[2, , , ], c(1,2), median, na.rm = TRUE)  # [variable x horizon]
lower_irf  <- apply(group_irfs_array[2, , , ], c(1,2), function(x) quantile(x, 0.25, na.rm = TRUE))
upper_irf  <- apply(group_irfs_array[2, , , ], c(1,2), function(x) quantile(x, 0.75, na.rm = TRUE))
group_irfs[[g]] <- list(median = median_irf, lower = lower_irf, upper = upper_irf)
} else {
message("Group ", g, " has no valid IRFs.")
}
}
return(group_irfs)
}
# Run for 68% IRFs
group_irfs_68 <- compute_group_irfs(proj_irfs_list_68, country_group_map)
plot_group_irfs <- function(group_irfs, group_name, var_names) {
irfs <- group_irfs[[group_name]]
if (is.null(irfs)) {
message("No IRFs for group ", group_name)
return(NULL)
}
horizons <- dim(irfs$median)[2]
variables <- dim(irfs$median)[1]
df <- data.frame()
for (v in 1:variables) {
for (h in 1:horizons) {
df <- rbind(df, data.frame(
variable = var_names[v],
horizon = h - 1,
median = irfs$median[v, h],
lower = irfs$lower[v, h],
upper = irfs$upper[v, h]
))
}
}
ggplot(df, aes(x = horizon, y = median)) +
geom_line(color = "blue") +
geom_ribbon(aes(ymin = lower, ymax = upper), fill = "lightblue", alpha = 0.3) +
facet_wrap(~ variable, scales = "free_y") +
labs(title = paste("Group IRFs for", group_name, "(68% Bands)"), y = "Response", x = "Horizon") +
theme_minimal()
}
plot_group_irfs(group_irfs_68, "High", var_names)
plot_group_irfs(group_irfs_68, "Low", var_names)
df_pcs <- df_pcs %>%
mutate(Trade_PC2_group = case_when(
Trade_PC2 >= quantile(Trade_PC2, 0.66, na.rm = TRUE) ~ "High",
Trade_PC2 <= quantile(Trade_PC2, 0.33, na.rm = TRUE) ~ "Low",
TRUE ~ "Mid"
))
country_group_map_trade2 <- df_pcs %>%
select(Country.Code, Trade_PC2_group) %>%
filter(Country.Code %in% names(proj_irfs_list_68))
country_group_map_trade2 <- df_pcs %>%
dplyr::select(Country.Code, Trade_PC2_group) %>%
filter(Country.Code %in% names(proj_irfs_list_68))
country_group_map_trade2 <- country_group_map_trade2 %>%
filter(Trade_PC2_group %in% c("High", "Low"))
group_irfs_68_trade2 <- compute_group_irfs(proj_irfs_list_68, country_group_map_trade2)
plot_group_irfs(group_irfs_68_trade2, "High", var_names)
plot_group_irfs(group_irfs_68_trade2, "Low", var_names)
# Set the PC to use for grouping
pc_column <- "Trade_PC2"  # Change to "Trade_PC2" or "BoP_PC3" etc.
group_column <- paste0(pc_column, "_group")
# Create High / Low / Mid groups for the chosen PC
df_pcs <- df_pcs %>%
mutate(!!group_column := case_when(
!!sym(pc_column) >= quantile(!!sym(pc_column), 0.66, na.rm = TRUE) ~ "High",
!!sym(pc_column) <= quantile(!!sym(pc_column), 0.33, na.rm = TRUE) ~ "Low",
TRUE ~ "Mid"
))
# Extract country to group mapping
country_group_map <- df_pcs %>%
dplyr::select(Country.Code, !!sym(group_column)) %>%
filter(Country.Code %in% names(proj_irfs_list_68)) %>%
rename(Group = !!sym(group_column))
compute_group_irfs <- function(proj_irfs_list, country_group_map) {
groups <- unique(country_group_map$Group)
group_irfs <- list()
for (g in groups) {
group_countries <- country_group_map %>%
filter(Group == g) %>%
pull(Country.Code)
group_irfs_array <- proj_irfs_list[group_countries] %>%
compact() %>% simplify2array()
if (length(dim(group_irfs_array)) == 4) {  # [quantiles x variables x horizons x countries]
median_irf <- apply(group_irfs_array[2, , , ], c(1,2), median, na.rm = TRUE)
lower_irf  <- apply(group_irfs_array[2, , , ], c(1,2), function(x) quantile(x, 0.25, na.rm = TRUE))
upper_irf  <- apply(group_irfs_array[2, , , ], c(1,2), function(x) quantile(x, 0.75, na.rm = TRUE))
group_irfs[[g]] <- list(median = median_irf, lower = lower_irf, upper = upper_irf)
} else {
message("Group ", g, " has no valid IRFs.")
}
}
return(group_irfs)
}
# Run for 68% IRFs
group_irfs_68 <- compute_group_irfs(proj_irfs_list_68, country_group_map)
plot_group_irfs(group_irfs_68, "High", var_names)
plot_group_irfs(group_irfs_68, "Low", var_names)
